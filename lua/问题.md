**全局变量**

Lua将其所有全球变量保存在常规表中，称为环境。（更确切地说，LUA将其“全局”变量保持在几种环境中，但是我们会忽略这种多重性一会儿。）这种结构的优势是简化了LUA的内部实现，因为不需要一个全局变量的不同数据结构。另一个（实际上是主要）优势是我们可以将此表操作为任何其他表。为了促进此类操作，LUA将环境本身存储在全球变量_G中。（是的，_g._g等于_g。）

全局变量是通过一个特殊的表"_G"来实现的，所有的全局变量存储在这个表中，访问全局变量时， 首先在当前作用域查找，然后在"_G"表中查找，

**函数闭包**

当一个函数包含在另一个函数中时，它可以完全访问来自包含函数的本地变量。此功能称为词法范围。尽管这听起来很明显，但事实并非如此。

我们称其为外部局部变量或一个upvalue。（“ upvalue”一词有点误导，因为等级是一个变量，而不是一个值。但是，该术语在LUA中具有历史根源，并且比“外部局部变量”短。

Simply put, a closure is a function plus all it needs to access its upvalues correctly

闭包的实现方式是将函数及其相关的环境打包成一个对象，并返回该对象作为函数的返回值。这样，返回的闭包函数就可以在函数创建时所在的环境外被调用，且可以访问和修改该环境中的变量。